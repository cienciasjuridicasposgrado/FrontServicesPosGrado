<mat-card class="form-card">
  <mat-card-header>
    <mat-card-title>
      <mat-icon>edit_note</mat-icon>
      Editar Observación - Salida #{{output?.id}}
    </mat-card-title>
    <mat-card-subtitle>Actualice la observación de la salida de inventario</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <div *ngIf="loading && !output" class="loading-center">
      <mat-spinner diameter="50"></mat-spinner>
      <span>Cargando salida...</span>
    </div>

    <div *ngIf="output" class="edit-content">
      <!-- Información de solo lectura -->
      <div class="readonly-info">
        <h4>Información de la Salida (No editable)</h4>
        <div class="info-grid">
          <div class="info-item">
            <strong>Ítem:</strong>
            <span>{{output.item?.nombreItem}} ({{output.itemCodigo}})</span>
          </div>
          <div class="info-item">
            <strong>Cantidad:</strong>
            <span>{{output.cantidad}} unidades</span>
          </div>
          <div class="info-item">
            <strong>Departamento:</strong>
            <span>{{output.departamento?.nombre}}</span>
          </div>
          <div class="info-item">
            <strong>Fecha:</strong>
            <span>{{output.fecha | date: 'dd/MM/yyyy HH:mm'}}</span>
          </div>
        </div>
      </div>

      <mat-divider></mat-divider>

      <!-- Formulario de edición -->
      <form [formGroup]="editForm" (ngSubmit)="onSubmit()" class="edit-form">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Observación</mat-label>
          <textarea matInput formControlName="observacion" rows="4" 
                    placeholder="Actualice la observación de esta salida..."></textarea>
          <mat-icon matSuffix>notes</mat-icon>
          <mat-hint>Máximo 500 caracteres</mat-hint>
          <mat-error *ngIf="editForm.get('observacion')?.hasError('maxlength')">
            Máximo 500 caracteres
          </mat-error>
        </mat-form-field>

        <div class="form-actions">
          <button mat-button type="button" (click)="onCancel()" [disabled]="loading">
            Cancelar
          </button>
          <button mat-raised-button color="primary" type="submit" 
                  [disabled]="loading || editForm.invalid">
            <mat-icon>save</mat-icon>
            <span *ngIf="!loading">Guardar Cambios</span>
            <mat-spinner *ngIf="loading" [diameter]="20"></mat-spinner>
          </button>
        </div>
      </form>
    </div>
  </mat-card-content>
</mat-card>